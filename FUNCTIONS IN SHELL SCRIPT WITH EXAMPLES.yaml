FUNCTIONS IN SHELL SCRIPT WITH EXAMPLES Admin  November 14, 2019  UNIX TUTORIAL
functions-in-shell-script
Below post explained in following sections.

How to declare a function in shell script
How to call a function in shell script
Function with parameters
Scope of Variables
Return values from functions
As like in almost all other programming languages, you can use functions in shell script to combine pieces of code in a more logical way or you can utilize functions for recursion.

If we talk about Functions, we know basic things like declaring function, defining function and calling function.

HOW TO DECLARE A FUNCTION IN SHELL SCRIPT
Declaring a function is just a matter of writing just function name with the curly braces like below.

Function code is not executed until the function is called. Functions are read in, but basically ignored until they are actually called.

?
1
2
3
4
my_function()
{
code_goes_here
}
Or

?
1
2
3
4
function my_function
{
code_goes_here
}
Below is the sample function declaration.

# A simple script with a function
bye_msg()
{
echo â€œyou just learnt function declaration in shell script. Time to leave!â€
}
HOW TO CALL A FUNCTION IN SHELL SCRIPT
Calling a function in shell script is just like calling another program, you just write its name if you donâ€™t have to pass any arguments.

If you have to pass arguments to function, you just pass them as like in shell script.

#!/bin/bash
# A simple script with to call function
echo â€œThis is starting line of the shell scriptâ€
bye_msg()
{
echo â€œyou just learnt function declaration in shell script. Time to leave!â€
}
bye_msg
echo â€œClosing the scriptâ€
Notice that a functions donâ€™t need to be declared in any specific order.

FUNCTION WITH PARAMETERS
#!/bin/bash
# A simple script with parameters to the function
quit() {
exit
}
param() {
echo $1
}
param hi
param hello
quit
echo â€œhow are you?â€
When running the script youâ€™ll notice that first: the function â€˜paramâ€™ is called, second the â€˜paramâ€™ function again, and â€˜quitâ€™ function. Here execution never reaches to last echo statement.

SCOPE OF VARIABLES
This is something different when you compare with other programming languages scope rules. Actually, there is no scoping, other than the parameters ($1, $2, $@, etc).

I will explain the scope using below short code.

#!/bin/sh
my_func()
{
echo â€œI was called as : $@â€
x=20
}
#Main script starts here
echo â€œScript was called with $@â€
x=10
echo â€œx is $xâ€
my_func 10 20 30
echo â€œx is $xâ€
The script, when called as â€œsample_scope.sh a b câ€, gives the following output:

[wot@unix ~] $ sh sample_scope.sh a b c
Script was called with a b c
x is 10
I was called as : 10 20 30
x is 20
[wot@unix ~] $
The $@ parameters are changed within the function to reflect how the function was called. The variable x, however, is effectively a global variable my_func changed it, and that change is still effective when control returns to the main script.

RETURN VALUES FROM FUNCTIONS
If you try execute an exit command from inside a function, its effects not only to terminate execution of the function but also of the shell program that called the function.

If you instead want to just terminate execution of the function, then there is way to come out of a defined function using â€˜returnâ€™.

Based on the requirement you can return any value from your function using the return command.

?
1
return code
Here code can be anything you choose here, but obviously you should choose something that is meaningful or useful in the context of your script as a whole.

Below example function will return the sum of 2 input parameters.

#!/bin/sh
# Define your function here
sum ()
{
echo â€œGiven numbers are $1 $2â€
a=`expr $1 + $2`
return $a
}

# Invoke your function
sum 3 5
# Capture value returned by last command
sumvalue=$?
echo â€œSum value is $sumvalueâ€

If you run this script, you get the output as follows.

[wot@unix ~] $ sh function_return.sh
Given numbers are 3 5
Sum value is 8
[wot@unix ~]
You can return anything from function such as strings and below example function will return strings.

#!/bin/bash
# Variables
site=â€WINGS OF TECHNOLOGYâ€
out=â€â€
##################################################################
# Purpose: Converts a string to lowercase
# Arguments:
# $@ -> String to convert to lowercase
##################################################################
function to_lower()
{
local str=â€$@â€
local output
output=$(tr â€˜[A-Z]â€™ â€˜[a-z]'<<<â€œ${str}â€)
echo $output
}# invoke the to_lower()
to_lower â€œThis Is a TESTâ€# invoke to_lower() and store its result to $out variable
out=$(to_lower ${site})# Display back the result from $out
echo â€œSite name : $outâ€
If you run the above script, you get the output as follows.

[wot@unix ~] $ sh function_output.sh
this is a test
Site name : wings of technology
[wot@unix ~] $
SHARING IS CARING ğŸ™‚